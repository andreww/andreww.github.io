<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.1//EN"
    "http://www.w3.org/TR/xhtml11/DTD/xhtml11.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
<head>
<meta http-equiv="Content-Type" content="application/xhtml+xml; charset=UTF-8" />
<meta name="generator" content="AsciiDoc 8.6.6" />
<title>Practical 3: Object oriented programming</title>
<style type="text/css">
/* Shared CSS for AsciiDoc xhtml11 and html5 backends */

/* Default font. */
body {
  font-family: Georgia,serif;
}

/* Title font. */
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
#toctitle,
#author, #revnumber, #revdate, #revremark,
#footer {
  font-family: Arial,Helvetica,sans-serif;
}

body {
  margin: 1em 5% 1em 5%;
}

a {
  color: blue;
  text-decoration: underline;
}
a:visited {
  color: fuchsia;
}

em {
  font-style: italic;
  color: navy;
}

strong {
  font-weight: bold;
  color: #083194;
}

h1, h2, h3, h4, h5, h6 {
  color: #527bbd;
  margin-top: 1.2em;
  margin-bottom: 0.5em;
  line-height: 1.3;
}

h1, h2, h3 {
  border-bottom: 2px solid silver;
}
h2 {
  padding-top: 0.5em;
}
h3 {
  float: left;
}
h3 + * {
  clear: left;
}
h5 {
  font-size: 1.0em;
}

div.sectionbody {
  margin-left: 0;
}

hr {
  border: 1px solid silver;
}

p {
  margin-top: 0.5em;
  margin-bottom: 0.5em;
}

ul, ol, li > p {
  margin-top: 0;
}
ul > li     { color: #aaa; }
ul > li > * { color: black; }

pre {
  padding: 0;
  margin: 0;
}

#author {
  color: #527bbd;
  font-weight: bold;
  font-size: 1.1em;
}
#email {
}
#revnumber, #revdate, #revremark {
}

#footer {
  font-size: small;
  border-top: 2px solid silver;
  padding-top: 0.5em;
  margin-top: 4.0em;
}
#footer-text {
  float: left;
  padding-bottom: 0.5em;
}
#footer-badges {
  float: right;
  padding-bottom: 0.5em;
}

#preamble {
  margin-top: 1.5em;
  margin-bottom: 1.5em;
}
div.imageblock, div.exampleblock, div.verseblock,
div.quoteblock, div.literalblock, div.listingblock, div.sidebarblock,
div.admonitionblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.admonitionblock {
  margin-top: 2.0em;
  margin-bottom: 2.0em;
  margin-right: 10%;
  color: #606060;
}

div.content { /* Block element content. */
  padding: 0;
}

/* Block element titles. */
div.title, caption.title {
  color: #527bbd;
  font-weight: bold;
  text-align: left;
  margin-top: 1.0em;
  margin-bottom: 0.5em;
}
div.title + * {
  margin-top: 0;
}

td div.title:first-child {
  margin-top: 0.0em;
}
div.content div.title:first-child {
  margin-top: 0.0em;
}
div.content + div.title {
  margin-top: 0.0em;
}

div.sidebarblock > div.content {
  background: #ffffee;
  border: 1px solid #dddddd;
  border-left: 4px solid #f0f0f0;
  padding: 0.5em;
}

div.listingblock > div.content {
  border: 1px solid #dddddd;
  border-left: 5px solid #f0f0f0;
  background: #f8f8f8;
  padding: 0.5em;
}

div.quoteblock, div.verseblock {
  padding-left: 1.0em;
  margin-left: 1.0em;
  margin-right: 10%;
  border-left: 5px solid #f0f0f0;
  color: #777777;
}

div.quoteblock > div.attribution {
  padding-top: 0.5em;
  text-align: right;
}

div.verseblock > pre.content {
  font-family: inherit;
  font-size: inherit;
}
div.verseblock > div.attribution {
  padding-top: 0.75em;
  text-align: left;
}
/* DEPRECATED: Pre version 8.2.7 verse style literal block. */
div.verseblock + div.attribution {
  text-align: left;
}

div.admonitionblock .icon {
  vertical-align: top;
  font-size: 1.1em;
  font-weight: bold;
  text-decoration: underline;
  color: #527bbd;
  padding-right: 0.5em;
}
div.admonitionblock td.content {
  padding-left: 0.5em;
  border-left: 3px solid #dddddd;
}

div.exampleblock > div.content {
  border-left: 3px solid #dddddd;
  padding-left: 0.5em;
}

div.imageblock div.content { padding-left: 0; }
span.image img { border-style: none; }
a.image:visited { color: white; }

dl {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
dt {
  margin-top: 0.5em;
  margin-bottom: 0;
  font-style: normal;
  color: navy;
}
dd > *:first-child {
  margin-top: 0.1em;
}

ul, ol {
    list-style-position: outside;
}
ol.arabic {
  list-style-type: decimal;
}
ol.loweralpha {
  list-style-type: lower-alpha;
}
ol.upperalpha {
  list-style-type: upper-alpha;
}
ol.lowerroman {
  list-style-type: lower-roman;
}
ol.upperroman {
  list-style-type: upper-roman;
}

div.compact ul, div.compact ol,
div.compact p, div.compact p,
div.compact div, div.compact div {
  margin-top: 0.1em;
  margin-bottom: 0.1em;
}

tfoot {
  font-weight: bold;
}
td > div.verse {
  white-space: pre;
}

div.hdlist {
  margin-top: 0.8em;
  margin-bottom: 0.8em;
}
div.hdlist tr {
  padding-bottom: 15px;
}
dt.hdlist1.strong, td.hdlist1.strong {
  font-weight: bold;
}
td.hdlist1 {
  vertical-align: top;
  font-style: normal;
  padding-right: 0.8em;
  color: navy;
}
td.hdlist2 {
  vertical-align: top;
}
div.hdlist.compact tr {
  margin: 0;
  padding-bottom: 0;
}

.comment {
  background: yellow;
}

.footnote, .footnoteref {
  font-size: 0.8em;
}

span.footnote, span.footnoteref {
  vertical-align: super;
}

#footnotes {
  margin: 20px 0 20px 0;
  padding: 7px 0 0 0;
}

#footnotes div.footnote {
  margin: 0 0 5px 0;
}

#footnotes hr {
  border: none;
  border-top: 1px solid silver;
  height: 1px;
  text-align: left;
  margin-left: 0;
  width: 20%;
  min-width: 100px;
}

div.colist td {
  padding-right: 0.5em;
  padding-bottom: 0.3em;
  vertical-align: top;
}
div.colist td img {
  margin-top: 0.3em;
}

@media print {
  #footer-badges { display: none; }
}

#toc {
  margin-bottom: 2.5em;
}

#toctitle {
  color: #527bbd;
  font-size: 1.1em;
  font-weight: bold;
  margin-top: 1.0em;
  margin-bottom: 0.1em;
}

div.toclevel1, div.toclevel2, div.toclevel3, div.toclevel4 {
  margin-top: 0;
  margin-bottom: 0;
}
div.toclevel2 {
  margin-left: 2em;
  font-size: 0.9em;
}
div.toclevel3 {
  margin-left: 4em;
  font-size: 0.9em;
}
div.toclevel4 {
  margin-left: 6em;
  font-size: 0.9em;
}

span.aqua { color: aqua; }
span.black { color: black; }
span.blue { color: blue; }
span.fuchsia { color: fuchsia; }
span.gray { color: gray; }
span.green { color: green; }
span.lime { color: lime; }
span.maroon { color: maroon; }
span.navy { color: navy; }
span.olive { color: olive; }
span.purple { color: purple; }
span.red { color: red; }
span.silver { color: silver; }
span.teal { color: teal; }
span.white { color: white; }
span.yellow { color: yellow; }

span.aqua-background { background: aqua; }
span.black-background { background: black; }
span.blue-background { background: blue; }
span.fuchsia-background { background: fuchsia; }
span.gray-background { background: gray; }
span.green-background { background: green; }
span.lime-background { background: lime; }
span.maroon-background { background: maroon; }
span.navy-background { background: navy; }
span.olive-background { background: olive; }
span.purple-background { background: purple; }
span.red-background { background: red; }
span.silver-background { background: silver; }
span.teal-background { background: teal; }
span.white-background { background: white; }
span.yellow-background { background: yellow; }

span.big { font-size: 2em; }
span.small { font-size: 0.6em; }

span.underline { text-decoration: underline; }
span.overline { text-decoration: overline; }
span.line-through { text-decoration: line-through; }


/*
 * xhtml11 specific
 *
 * */

tt {
  font-family: monospace;
  font-size: inherit;
  color: navy;
}

div.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
div.tableblock > table {
  border: 3px solid #527bbd;
}
thead, p.table.header {
  font-weight: bold;
  color: #527bbd;
}
p.table {
  margin-top: 0;
}
/* Because the table frame attribute is overriden by CSS in most browsers. */
div.tableblock > table[frame="void"] {
  border-style: none;
}
div.tableblock > table[frame="hsides"] {
  border-left-style: none;
  border-right-style: none;
}
div.tableblock > table[frame="vsides"] {
  border-top-style: none;
  border-bottom-style: none;
}


/*
 * html5 specific
 *
 * */

.monospaced {
  font-family: monospace;
  font-size: inherit;
  color: navy;
}

table.tableblock {
  margin-top: 1.0em;
  margin-bottom: 1.5em;
}
thead, p.tableblock.header {
  font-weight: bold;
  color: #527bbd;
}
p.tableblock {
  margin-top: 0;
}
table.tableblock {
  border-width: 3px;
  border-spacing: 0px;
  border-style: solid;
  border-color: #527bbd;
  border-collapse: collapse;
}
th.tableblock, td.tableblock {
  border-width: 1px;
  padding: 4px;
  border-style: solid;
  border-color: #527bbd;
}

table.tableblock.frame-topbot {
  border-left-style: hidden;
  border-right-style: hidden;
}
table.tableblock.frame-sides {
  border-top-style: hidden;
  border-bottom-style: hidden;
}
table.tableblock.frame-none {
  border-style: hidden;
}

th.tableblock.halign-left, td.tableblock.halign-left {
  text-align: left;
}
th.tableblock.halign-center, td.tableblock.halign-center {
  text-align: center;
}
th.tableblock.halign-right, td.tableblock.halign-right {
  text-align: right;
}

th.tableblock.valign-top, td.tableblock.valign-top {
  vertical-align: top;
}
th.tableblock.valign-middle, td.tableblock.valign-middle {
  vertical-align: middle;
}
th.tableblock.valign-bottom, td.tableblock.valign-bottom {
  vertical-align: bottom;
}


/*
 * manpage specific
 *
 * */

body.manpage h1 {
  padding-top: 0.5em;
  padding-bottom: 0.5em;
  border-top: 2px solid silver;
  border-bottom: 2px solid silver;
}
body.manpage h2 {
  border-style: none;
}
body.manpage div.sectionbody {
  margin-left: 3em;
}

@media print {
  body.manpage div#toc { display: none; }
}


/*
 * Theme specific overrides of the preceding (asciidoc.css) CSS.
 *
 */
body {
  font-family: Garamond, Georgia, serif;
  font-size: 17px;
  color: #3E4349;
  line-height: 1.3em;
}
h1, h2, h3, h4, h5, h6,
div.title, caption.title,
thead, p.table.header,
#toctitle,
#author, #revnumber, #revdate, #revremark,
#footer {
  font-family: Garmond, Georgia, serif;
  font-weight: normal;
  border-bottom-width: 0;
  color: #3E4349;
}
div.title, caption.title { color: #596673; font-weight: bold; }
h1 { font-size: 240%; }
h2 { font-size: 180%; }
h3 { font-size: 150%; }
h4 { font-size: 130%; }
h5 { font-size: 115%; }
h6 { font-size: 100%; }
#header h1 { margin-top: 0; }
#toc {
  color: #444444;
  line-height: 1.5;
  padding-top: 1.5em;
}
#toctitle {
  font-size: 20px;
}
#toc a {
    border-bottom: 1px dotted #999999;
    color: #444444 !important;
    text-decoration: none !important;
}
#toc a:hover {
    border-bottom: 1px solid #6D4100;
    color: #6D4100 !important;
    text-decoration: none !important;
}
div.toclevel1 { margin-top: 0.2em; font-size: 16px; }
div.toclevel2 { margin-top: 0.15em; font-size: 14px; }
em, dt, td.hdlist1 { color: black; }
strong { color: #3E4349; }
a { color: #004B6B; text-decoration: none; border-bottom: 1px dotted #004B6B; }
a:visited { color: #615FA0; border-bottom: 1px dotted #615FA0; }
a:hover { color: #6D4100; border-bottom: 1px solid #6D4100; }
div.tableblock > table, table.tableblock { border: 3px solid #E8E8E8; }
th.tableblock, td.tableblock { border: 1px solid #E8E8E8; }
ul > li > * { color: #3E4349; }
pre, tt, .monospaced { font-family: Consolas,Menlo,'Deja Vu Sans Mono','Bitstream Vera Sans Mono',monospace; }
tt, .monospaced { font-size: 0.9em; color: black;
}
div.exampleblock > div.content, div.sidebarblock > div.content, div.listingblock > div.content { border-width: 0 0 0 3px; border-color: #E8E8E8; }
div.verseblock { border-left-width: 0; margin-left: 3em; }
div.quoteblock { border-left-width: 3px; margin-left: 0; margin-right: 0;}
div.admonitionblock td.content { border-left: 3px solid #E8E8E8; }
</style>
<script type="text/javascript">
/*<![CDATA[*/
var asciidoc = {  // Namespace.

/////////////////////////////////////////////////////////////////////
// Table Of Contents generator
/////////////////////////////////////////////////////////////////////

/* Author: Mihai Bazon, September 2002
 * http://students.infoiasi.ro/~mishoo
 *
 * Table Of Content generator
 * Version: 0.4
 *
 * Feel free to use this script under the terms of the GNU General Public
 * License, as long as you do not remove or alter this notice.
 */

 /* modified by Troy D. Hanson, September 2006. License: GPL */
 /* modified by Stuart Rackham, 2006, 2009. License: GPL */

// toclevels = 1..4.
toc: function (toclevels) {

  function getText(el) {
    var text = "";
    for (var i = el.firstChild; i != null; i = i.nextSibling) {
      if (i.nodeType == 3 /* Node.TEXT_NODE */) // IE doesn't speak constants.
        text += i.data;
      else if (i.firstChild != null)
        text += getText(i);
    }
    return text;
  }

  function TocEntry(el, text, toclevel) {
    this.element = el;
    this.text = text;
    this.toclevel = toclevel;
  }

  function tocEntries(el, toclevels) {
    var result = new Array;
    var re = new RegExp('[hH]([2-'+(toclevels+1)+'])');
    // Function that scans the DOM tree for header elements (the DOM2
    // nodeIterator API would be a better technique but not supported by all
    // browsers).
    var iterate = function (el) {
      for (var i = el.firstChild; i != null; i = i.nextSibling) {
        if (i.nodeType == 1 /* Node.ELEMENT_NODE */) {
          var mo = re.exec(i.tagName);
          if (mo && (i.getAttribute("class") || i.getAttribute("className")) != "float") {
            result[result.length] = new TocEntry(i, getText(i), mo[1]-1);
          }
          iterate(i);
        }
      }
    }
    iterate(el);
    return result;
  }

  var toc = document.getElementById("toc");
  if (!toc) {
    return;
  }

  // Delete existing TOC entries in case we're reloading the TOC.
  var tocEntriesToRemove = [];
  var i;
  for (i = 0; i < toc.childNodes.length; i++) {
    var entry = toc.childNodes[i];
    if (entry.nodeName == 'div'
     && entry.getAttribute("class")
     && entry.getAttribute("class").match(/^toclevel/))
      tocEntriesToRemove.push(entry);
  }
  for (i = 0; i < tocEntriesToRemove.length; i++) {
    toc.removeChild(tocEntriesToRemove[i]);
  }

  // Rebuild TOC entries.
  var entries = tocEntries(document.getElementById("content"), toclevels);
  for (var i = 0; i < entries.length; ++i) {
    var entry = entries[i];
    if (entry.element.id == "")
      entry.element.id = "_toc_" + i;
    var a = document.createElement("a");
    a.href = "#" + entry.element.id;
    a.appendChild(document.createTextNode(entry.text));
    var div = document.createElement("div");
    div.appendChild(a);
    div.className = "toclevel" + entry.toclevel;
    toc.appendChild(div);
  }
  if (entries.length == 0)
    toc.parentNode.removeChild(toc);
},


/////////////////////////////////////////////////////////////////////
// Footnotes generator
/////////////////////////////////////////////////////////////////////

/* Based on footnote generation code from:
 * http://www.brandspankingnew.net/archive/2005/07/format_footnote.html
 */

footnotes: function () {
  // Delete existing footnote entries in case we're reloading the footnodes.
  var i;
  var noteholder = document.getElementById("footnotes");
  if (!noteholder) {
    return;
  }
  var entriesToRemove = [];
  for (i = 0; i < noteholder.childNodes.length; i++) {
    var entry = noteholder.childNodes[i];
    if (entry.nodeName == 'div' && entry.getAttribute("class") == "footnote")
      entriesToRemove.push(entry);
  }
  for (i = 0; i < entriesToRemove.length; i++) {
    noteholder.removeChild(entriesToRemove[i]);
  }

  // Rebuild footnote entries.
  var cont = document.getElementById("content");
  var spans = cont.getElementsByTagName("span");
  var refs = {};
  var n = 0;
  for (i=0; i<spans.length; i++) {
    if (spans[i].className == "footnote") {
      n++;
      var note = spans[i].getAttribute("data-note");
      if (!note) {
        // Use [\s\S] in place of . so multi-line matches work.
        // Because JavaScript has no s (dotall) regex flag.
        note = spans[i].innerHTML.match(/\s*\[([\s\S]*)]\s*/)[1];
        spans[i].innerHTML =
          "[<a id='_footnoteref_" + n + "' href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
        spans[i].setAttribute("data-note", note);
      }
      noteholder.innerHTML +=
        "<div class='footnote' id='_footnote_" + n + "'>" +
        "<a href='#_footnoteref_" + n + "' title='Return to text'>" +
        n + "</a>. " + note + "</div>";
      var id =spans[i].getAttribute("id");
      if (id != null) refs["#"+id] = n;
    }
  }
  if (n == 0)
    noteholder.parentNode.removeChild(noteholder);
  else {
    // Process footnoterefs.
    for (i=0; i<spans.length; i++) {
      if (spans[i].className == "footnoteref") {
        var href = spans[i].getElementsByTagName("a")[0].getAttribute("href");
        href = href.match(/#.*/)[0];  // Because IE return full URL.
        n = refs[href];
        spans[i].innerHTML =
          "[<a href='#_footnote_" + n +
          "' title='View footnote' class='footnote'>" + n + "</a>]";
      }
    }
  }
},

install: function(toclevels) {
  var timerId;

  function reinstall() {
    asciidoc.footnotes();
    if (toclevels) {
      asciidoc.toc(toclevels);
    }
  }

  function reinstallAndRemoveTimer() {
    clearInterval(timerId);
    reinstall();
  }

  timerId = setInterval(reinstall, 500);
  if (document.addEventListener)
    document.addEventListener("DOMContentLoaded", reinstallAndRemoveTimer, false);
  else
    window.onload = reinstallAndRemoveTimer;
}

}
asciidoc.install();
/*]]>*/
</script>
</head>
<body class="article">
<div id="header">
<h1>Practical 3: Object oriented programming</h1>
<span id="author">Andrew Walker</span><br />
<span id="email"><tt>&lt;<a href="mailto:andrew.walker@bristol.ac.uk">andrew.walker@bristol.ac.uk</a>&gt;</tt></span><br />
<span id="revnumber">version 1.0</span>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph"><p>We&#8217;ve seen that it&#8217;s not necessary to know about
object-oriented (OO) programming to write useful
tools using Python. However, Python is an OO
language and knowing something about how
object-orientation works and is implemented in
Python will help you understand many features of
the language. It is sometimes useful to write your
programs in an OO style. More commonly, you will make
use of a library that provides an OO interface. Knowing
how to write your own OO interface will help you make
use of other peoples designs.</p></div>
<div class="paragraph"><p>In this session you will explore how to make use of
modules from the standard library that expose OO interfaces.
You will then modify the rainfall analysis code you wrote on
Tuesday so that each weather station&#8217;s data is represented by
an object. This will allow you to produce more complex
analysis easily without producing excessively complex code. First
we will look at some objects from the standard library</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_exercise_1_random_numbers_and_dates_objects_from_the_outside">Exercise 1: Random numbers and dates – objects from the outside</h2>
<div class="sectionbody">
<div class="paragraph"><p>It is often useful to be able to generate (pseudo-) random numbers
for use in numerical programs. These can be used for Monte-Carlo
simulation or error analysis. Random number generators can be
modelled as objects. The way that numbers are generated is hidden
in a "black box". Methods are provided to set up (seed) the
generator and return a random number drawn from some distribution.</p></div>
<div class="paragraph"><p>Write a simple Python program to calculate the average of 100 random
numbers drawn from the range [0.0, 1.0). You will need to import the
<tt>random</tt> module, create an instance of the <tt>random.Random</tt> class, use
the instance&#8217;s <tt>seed()</tt> method to set up the generator, and then use
the <tt>random()</tt> method to generate each random number. In this case, neither
the class constructor, <tt>random()</tt> or <tt>seed()</tt> need arguments.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">
<div class="paragraph"><p>Remember that
instances of any class look like variables and methods can be called
by appending a dot and the method name (with arguments in brackets) to
the instance. That is, a new instance of the class <tt>Thing</tt> is created
by the code <tt>this_thing = Thing(constructer_argument)</tt>. Methods and
attributes of the instance <tt>this_thing</tt> can then be accessed as
<tt>this_thing.method(method_argument)</tt> and <tt>this_thing.attribute</tt>.</p></div>
</td>
</tr></table>
</div>
<div class="paragraph"><p>Another class provided by the standard library creates
<tt>date</tt> objects. This is available from the <tt>datetime</tt> module.
Unlike the random number class, the <tt>date</tt> class constructor
accepts arguments, specifically three integers giving the year,
 month and day of the date to be represented. Start up a Python
interpreter and <tt>import</tt> the datetime module. Create two <tt>date</tt>
objects, one representing February 3, 1700 and one representing
October 4, 1701. What is the day of the week of these two dates?
You can use the <tt>weekday()</tt> method to find out (this returns 0
for Monday, 1 for Tuesday and 6 for Sunday).  How many days are
there between the two dates? (Note that arithmetic with date
objects return a <tt>timedelta</tt> object, these have the attribute
<tt>days</tt>.) Repeat the exercise for February and October 2000 and
2001. Is the number of days between the two dates the
same? If not, why not?</p></div>
</div>
</div>
<div class="sect1">
<h2 id="_exercise_2_compressed_data_input_using_objects_for_flexibility">Exercise 2: Compressed data input – using objects for flexibility</h2>
<div class="sectionbody">
<div class="paragraph"><p>Data files are often compressed and it can be helpful
if your analysis code can read (and write) to compressed
files. As well as being convenient (you can avoid explicitly
compressing or decompressing files before and after you run
the analysis script) this can also improve execution time
(which is sometimes limited just by the process of getting
data to and from the disk). In common with all data types,
we have seen that Python’s built in file type is a class.
An instance of this type is returned by the built-in
<tt>open()</tt> function and each instance supports a range of
methods including iteration. The standard library includes
the <a href="http://docs.python.org/library/gzip.html">module <tt>gzip</tt></a>
 which implements the <tt>GzipFile</tt> class with
methods that simulate most of those provided by the built-in
file type. There is also a
<a href="http://docs.python.org/library/bz2.html"><tt>bz2</tt> module</a>,
which does a similar
thing for bzip2 compression. The directory <tt>metoffice_data</tt> contains
more Met Office data like that you worked with on Tuesday.
However, some files
have been compressed using either bzip2 or gzip. Modify your
final data file reading function to automatically accept
compressed files. You can assume that compressed files will
always have the .gz or .bz2 file extension.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">
<div class="paragraph"><p>The most obvious OO way to instantiate an object to
represent a compressed file is to make direct use of the
GzipFile class as follows:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt><strong>import</strong> gzip
f = gzip.GzipFile('filename', 'rb')
<i># Do something with f</i>
f.close()</tt></pre>
</div></div>
<div class="paragraph"><p>However, this is different to the way that Python generates
built-in file objects using the <tt>open()</tt> function. A more
natural approach is probably to use the gzip module&#8217;s <tt>open()</tt>
function thus:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt><strong>import</strong> gzip
f = gzip.open('filename', 'rb')
<i># Do something with f</i>
f.close()</tt></pre>
</div></div>
<div class="paragraph"><p>In this approach, <tt>gzip.open()</tt> is nothing more
than a convenience wrapper around the <tt>GzipFile</tt>
class constructor. The <tt>bz2</tt> module lacks an
equivalent function so you will have to make
use of the <tt>BZ2File</tt> class directly.</p></div>
</td>
</tr></table>
</div>
<div class="paragraph"><p>Does your modified code work with uncompressed files as well
as files compressed with both gzip and bzip2?</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/tip.png" alt="Tip" />
</td>
<td class="content">You will need to be able to decide if the filename argument
represents a compressed file. One way to do this is to use string
methods to examine the file name argument. A better (easer and
more portable) approach is to use the <tt>splitext()</tt> function from
the <tt>os.path</tt> module. This takes a string as an argument returns
a tuple who&#8217;s second item is the final file extension
(<tt>.txt</tt>, <tt>.gz</tt> or <tt>.bzip2</tt>).</td>
</tr></table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_exercise_3_rainfall_an_object_from_the_inside">Exercise 3: Rainfall – an object from the inside</h2>
<div class="sectionbody">
<div class="paragraph"><p>The "dictionary of lists" data structure you used to
hold rainfall data in Practical 2 works, but is
unsatisfactory in a number of ways. The functions you
wrote were tied to the data structure so knowledge of
the data structure ended up being spread around your
code making refactoring difficult. It would sometimes
be useful to generate a different "view" of the data,
say by providing a list of rainfall for each January
in the data set to make it easy to calculate the
average rainfall in that month. In this exercise
you should create a <tt>Rainfall</tt> class to represent
a weather station and the rainfall it has measured.</p></div>
<div class="admonitionblock">
<table><tr>
<td class="icon">
<img src="./images/icons/note.png" alt="Note" />
</td>
<td class="content">
<div class="paragraph"><p>Remember that the way to define a class in Python
is to make use of the <tt>Class</tt> statement and define
functions for methods and variables for attributes.
Functions take an extra <tt>self</tt> argument and you need
an <tt>__init__</tt> method which gets called when you create
an instance.  The basic code looks like this:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt><strong>class</strong> Thing:
    <strong>def</strong> __init__(self, constructer_argument):
        <i># These values are created</i>
        <i># when the class is instantiated.</i>
        self.attribute = constructer_argument/7.65
        self.counter = 0

    <strong>def</strong> method(self, method_argument):
        self.counter = self.counter + method_argument
        <strong>print</strong> self.counter</tt></pre>
</div></div>
</td>
</tr></table>
</div>
<div class="paragraph"><p>The first step is to create the bare bones of your
<tt>Rainfall</tt> class reusing some of the code you wrote
on Tuesday. Start off with the class definition and
<tt>__init__</tt> method. <tt>__init__</tt> should take an argument
specifying the filename  where data will be read from.
What other argument is needed? Give your class
attributes for the weather station name, its latitude
and longitude. Store the data away inside the class as
a dictionary of lists.</p></div>
<div class="paragraph"><p>Now add methods. An <tt>annual_rainfall</tt> method could
return a dictionary with years as the keys and the
total measured rainfall in that year as the values.</p></div>
<div class="ulist"><ul>
<li>
<p>
Can you use your new class to calculate the distance
between pairs of weather stations?
</p>
</li>
<li>
<p>
Can you calculate the difference in average annual
rainfall for two weather stations?
</p>
</li>
</ul></div>
<div class="paragraph"><p>You are going to need a more flexible method of extracting
subsets of the rainfall information from your xi`Rainfall`
objects. Create a new method called <tt>list_data()</tt> that returns
two lists: a list of floating point numbers giving the rainfall
in each month and a list of <tt>date</tt> objects corresponding to
the first day of the month referred to in the first list. Add
three optional arguments to the <tt>list_data()</tt> method. New <tt>start</tt>
and <tt>end</tt> arguments should take date objects and (if the arguments
are present) no data before <tt>start</tt> or after <tt>end</tt>
should be returned. The third new argument <tt>months</tt> should
be a list to allow only a subset of the months to be
returned. Once this has been done, you should be able to
extract the rainfall data for the winter in Camborne
during the 1990s by doing:</p></div>
<div class="listingblock">
<div class="content">
<pre><tt><i># Read data from file and set up object</i>
r = Rainfall("cambornedate.txt.gz")
<i># extract winter (Dec, Jan, Feb) data for the 1990s</i>
rain, months = r.list_data(start=date(1990,1,1),end=(1999,12,31),months=[12,1,2])</tt></pre>
</div></div>
<div class="ulist"><ul>
<li>
<p>
Is spring wetter than autumn in Camborne?
</p>
</li>
<li>
<p>
Are winters in Cambridge drier than summers in Yeovilton?
</p>
</li>
</ul></div>
<div class="paragraph"><p>Finally, you may want to reexamine how the <tt>Rainfall</tt> class
you have constructed handles missing data. So far the
simple approach of representing missing months of rainfall
as having zero rainfall seems to have worked. Is there a
better built in type (with a single value) that could be
used? Can you modify your <tt>Rainfall</tt> class to handle
missing data more correctly?</p></div>
</div>
</div>
</div>
<div id="footnotes"><hr /></div>
<div id="footer">
<div id="footer-text">
Version 1.0<br />
Last updated 2011-09-26 11:16:41 BST
</div>
</div>
</body>
</html>
